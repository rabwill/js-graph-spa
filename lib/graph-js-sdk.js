var MicrosoftGraph=function(e){"use strict";function t(e,t){return e(t={exports:{}},t.exports),t.exports}var r=t((function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var o=t&&t.prototype instanceof l?t:l,i=Object.create(o.prototype),a=new k(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return A()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=c(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(e,r,a),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function l(){}function f(){}function h(){}var p={};p[o]=function(){return this};var v=Object.getPrototypeOf,y=v&&v(v(R([])));y&&y!==t&&r.call(y,o)&&(p=y);var m=h.prototype=l.prototype=Object.create(p);function g(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){var n;this._invoke=function(o,i){function a(){return new t((function(n,a){!function n(o,i,a,s){var u=c(e[o],e,i);if("throw"!==u.type){var d=u.arg,l=d.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){d.value=e,a(d)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}(o,i,n,a)}))}return n=n?n.then(a,a):a()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function R(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return f.prototype=m.constructor=h,h.constructor=f,f.displayName=s(h,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},g(x.prototype),x.prototype[i]=function(){return this},e.AsyncIterator=x,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new x(u(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},g(m),s(m,a,"Generator"),m[o]=function(){return this},m.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=R,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),E(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:R(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));var n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i,a=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */function s(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}function u(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(i||(i={}));var d=function(){function e(t){if(n(this,e),this.requests=new Map,void 0!==t){var r=e.requestLimit;if(t.length>r){var o=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(r));throw o.name="Limit Exceeded Error",o}var i,a=u(t);try{for(a.s();!(i=a.n()).done;){var s=i.value;this.addRequest(s)}}catch(e){a.e(e)}finally{a.f()}}}return a(e,[{key:"addRequest",value:function(t){var r=e.requestLimit;if(""===t.id){var n=new Error("Id for a request is empty, Please provide an unique id");throw n.name="Empty Id For Request",n}if(this.requests.size===r){var o=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(r));throw o.name="Limit Exceeded Error",o}if(this.requests.has(t.id)){var i=new Error("Adding request with duplicate id ".concat(t.id,", Make the id of the requests unique"));throw i.name="Duplicate RequestId Error",i}return this.requests.set(t.id,t),t.id}},{key:"removeRequest",value:function(e){for(var t=this.requests.delete(e),r=this.requests.entries(),n=r.next();!n.done;){var o=n.value[1].dependsOn;if(void 0!==o){var i=o.indexOf(e);-1!==i&&o.splice(i,1),0===o.length&&delete n.value[1].dependsOn}n=r.next()}return t}},{key:"getContent",value:function(){return s(this,void 0,void 0,r.mark((function t(){var n,o,i,a,s,u,c,d,l;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o={requests:n=[]},i=this.requests.entries(),!(a=i.next()).done){t.next=8;break}throw(s=new Error("No requests added yet, Please add at least one request.")).name="Empty Payload",s;case 8:if(e.validateDependencies(this.requests)){t.next=12;break}throw(u=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.")).name="Invalid Dependency",u;case 12:if(a.done){t.next=27;break}return c=a.value[1],t.next=16,e.getRequestData(c.request);case 16:if(void 0===(d=t.sent).body||void 0!==d.headers&&void 0!==d.headers["content-type"]){t.next=21;break}throw(l=new Error("Content-type header is not mentioned for request #".concat(c.id,", For request having body, Content-type header should be mentioned"))).name="Invalid Content-type header",l;case 21:d.id=c.id,void 0!==c.dependsOn&&c.dependsOn.length>0&&(d.dependsOn=c.dependsOn),n.push(d),a=i.next(),t.next=12;break;case 27:return o.requests=n,t.abrupt("return",o);case 29:case"end":return t.stop()}}),t,this)})))}},{key:"addDependency",value:function(e,t){if(!this.requests.has(e)){var r=new Error("Dependent ".concat(e," does not exists, Please check the id"));throw r.name="Invalid Dependent",r}if(void 0!==t&&!this.requests.has(t)){var n=new Error("Dependency ".concat(t," does not exists, Please check the id"));throw n.name="Invalid Dependency",n}if(void 0!==t){var o=this.requests.get(e);if(void 0===o.dependsOn&&(o.dependsOn=[]),-1!==o.dependsOn.indexOf(t)){var i=new Error("Dependency ".concat(t," is already added for the request ").concat(e));throw i.name="Duplicate Dependency",i}o.dependsOn.push(t)}else{for(var a,s=this.requests.entries(),u=s.next();!u.done&&u.value[1].id!==e;)a=u,u=s.next();if(void 0===a){var c=new Error("Can't add dependency ".concat(t,", There is only a dependent request in the batch"));throw c.name="Invalid Dependency Addition",c}var d=a.value[0];if(void 0===u.value[1].dependsOn&&(u.value[1].dependsOn=[]),-1!==u.value[1].dependsOn.indexOf(d)){var l=new Error("Dependency ".concat(d," is already added for the request ").concat(e));throw l.name="Duplicate Dependency",l}u.value[1].dependsOn.push(d)}}},{key:"removeDependency",value:function(e,t){var r=this.requests.get(e);if(void 0===r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if(void 0!==t){var n=r.dependsOn.indexOf(t);return-1!==n&&(r.dependsOn.splice(n,1),!0)}return delete r.dependsOn,!0}}],[{key:"validateDependencies",value:function(e){if(0===e.size){var t=new Error("Empty requests map, Please provide at least one request.");throw t.name="Empty Requests Error",t}return function(e){for(var t=e.entries(),r=t.next();!r.done;){var n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;r=t.next()}return!0}(e)||function(e){var t=e.entries(),r=t.next(),n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;var o=r;for(r=t.next();!r.done;){var i=r.value[1];if(void 0===i.dependsOn||1!==i.dependsOn.length||i.dependsOn[0]!==o.value[1].id)return!1;o=r,r=t.next()}return!0}(e)||function(e){var t,r=e.entries(),n=r.next(),o=n.value[1];if(void 0===o.dependsOn||0===o.dependsOn.length)t=o.id;else{if(1!==o.dependsOn.length)return!1;var i=o.dependsOn[0];if(i===o.id||!e.has(i))return!1;t=i}for(n=r.next();!n.done;){var a=n.value[1];if((void 0===a.dependsOn||0===a.dependsOn.length)&&t!==a.id)return!1;if(void 0!==a.dependsOn&&0!==a.dependsOn.length){if(1===a.dependsOn.length&&(a.id===t||a.dependsOn[0]!==t))return!1;if(a.dependsOn.length>1)return!1}n=r.next()}return!0}(e)}},{key:"getRequestData",value:function(t){return s(this,void 0,void 0,r.mark((function n(){var o,a,s;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o={url:""},a=new RegExp("^https?://"),o.url=a.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,o.method=t.method,s={},t.headers.forEach((function(e,t){s[t]=e})),Object.keys(s).length&&(o.headers=s),t.method!==i.PATCH&&t.method!==i.POST&&t.method!==i.PUT){r.next=11;break}return r.next=10,e.getRequestBody(t);case 10:o.body=r.sent;case 11:return r.abrupt("return",o);case 12:case"end":return r.stop()}}),n)})))}},{key:"getRequestBody",value:function(e){return s(this,void 0,void 0,r.mark((function t(){var n,o,i,a,s,u;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!1,t.prev=1,i=e.clone(),t.next=5,i.json();case 5:o=t.sent,n=!0,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(1);case 11:if(n){t.next=33;break}if(t.prev=12,"undefined"==typeof Blob){t.next=23;break}return t.next=16,e.blob();case 16:return a=t.sent,s=new FileReader,t.next=20,new Promise((function(e){s.addEventListener("load",(function(){var t=s.result,r=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(r[4])}),!1),s.readAsDataURL(a)}));case 20:o=t.sent,t.next=28;break;case 23:if("undefined"==typeof Buffer){t.next=28;break}return t.next=26,e.buffer();case 26:u=t.sent,o=u.toString("base64");case 28:n=!0,t.next=33;break;case 31:t.prev=31,t.t1=t.catch(12);case 33:return t.abrupt("return",o);case 34:case"end":return t.stop()}}),t,null,[[1,9],[12,31]])})))}}]),e}();d.requestLimit=20;var l=function(){function e(t){n(this,e),this.responses=new Map,this.update(t)}return a(e,[{key:"createResponseObject",value:function(e){var t=e.body,r={};if(r.status=e.status,void 0!==e.statusText&&(r.statusText=e.statusText),r.headers=e.headers,void 0!==r.headers&&void 0!==r.headers["Content-Type"]&&"application/json"===r.headers["Content-Type"].split(";")[0]){var n=JSON.stringify(t);return new Response(n,r)}return new Response(t,r)}},{key:"update",value:function(e){this.nextLink=e["@odata.nextLink"];for(var t=e.responses,r=0,n=t.length;r<n;r++)this.responses.set(t[r].id,this.createResponseObject(t[r]))}},{key:"getResponseById",value:function(e){return this.responses.get(e)}},{key:"getResponses",value:function(){return this.responses}},{key:"getResponsesIterator",value:r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.responses.entries(),n=t.next();case 2:if(n.done){e.next=8;break}return e.next=5,n.value;case 5:n=t.next(),e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))}]),e}(),f=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn"]),h=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],p=function(e){var t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e},v=function(e){if(-1!==(e=e.toLowerCase()).indexOf("https://")){var t=(e=e.replace("https://","")).indexOf(":"),r=e.indexOf("/"),n="";if(-1!==r)return-1!==t&&t<r?(n=e.substring(0,t),f.has(n)):(n=e.substring(0,r),f.has(n))}return!1};function y(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n(this,e),this.middlewareOptions=new Map;var r,o=y(t);try{for(o.s();!(r=o.n()).done;){var i=r.value,a=i.constructor;this.middlewareOptions.set(a,i)}}catch(e){o.e(e)}finally{o.f()}}return a(e,[{key:"getMiddlewareOptions",value:function(e){return this.middlewareOptions.get(e)}},{key:"setMiddlewareOptions",value:function(e,t){this.middlewareOptions.set(e,t)}}]),e}();var x,w=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},b=function(){for(var e="",t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},E=function(e,t,r){var n=null;if("undefined"!=typeof Request&&e instanceof Request)n=e.headers.get(r);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)n=t.headers.get(r);else if(t.headers instanceof Array){for(var o=t.headers,i=0,a=o.length;i<a;i++)if(o[i][0]===r){n=o[i][1];break}}else void 0!==t.headers[r]&&(n=t.headers[r]);return n},k=function(e,t,r,n){if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(r,n);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers(w({},r,n));else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(r,n);else if(t.headers instanceof Array){for(var o=0,i=t.headers.length;o<i;o++){var a=t.headers[o];if(a[0]===r){a[1]=n;break}}o===i&&t.headers.push([r,n])}else Object.assign(t.headers,w({},r,n))},R=function(e,t,r,n){"undefined"!=typeof Request&&e instanceof Request?e.headers.append(r,n):void 0!==t&&(void 0===t.headers?t.headers=new Headers(w({},r,n)):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(r,n):t.headers instanceof Array?t.headers.push([r,n]):void 0===t.headers?t.headers=w({},r,n):void 0===t.headers[r]?t.headers[r]=n:t.headers[r]+=", ".concat(n))},A=function(e,t){return s(void 0,void 0,void 0,r.mark((function n(){var o,i,a,s,u,c,d,l,f,h,p,v;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.headers.get("Content-Type")){r.next=6;break}return r.next=3,t.blob();case 3:r.t0=r.sent,r.next=9;break;case 6:return r.next=8,Promise.resolve(void 0);case 8:r.t0=r.sent;case 9:return o=r.t0,i=t.method,a=t.headers,s=t.referrer,u=t.referrerPolicy,c=t.mode,d=t.credentials,l=t.cache,f=t.redirect,h=t.integrity,p=t.keepalive,v=t.signal,r.abrupt("return",new Request(e,{method:i,headers:a,body:o,referrer:s,referrerPolicy:u,mode:c,credentials:d,cache:l,redirect:f,integrity:h,keepalive:p,signal:v}));case 12:case"end":return r.stop()}}),n)})))},O=function e(t,r){n(this,e),this.authenticationProvider=t,this.authenticationProviderOptions=r};(x=e.FeatureUsageFlag||(e.FeatureUsageFlag={}))[x.NONE=0]="NONE",x[x.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",x[x.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",x[x.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED";var T=function(){function t(){n(this,t),this.featureUsage=e.FeatureUsageFlag.NONE}return a(t,[{key:"setFeatureUsage",value:function(e){this.featureUsage=this.featureUsage|e}},{key:"getFeatureUsage",value:function(){return this.featureUsage.toString(16)}}],[{key:"updateFeatureUsageFlag",value:function(e,r){var n;e.middlewareControl instanceof g?n=e.middlewareControl.getMiddlewareOptions(t):e.middlewareControl=new g,void 0===n&&(n=new t,e.middlewareControl.setMiddlewareOptions(t,n)),n.setFeatureUsage(r)}}]),t}(),S=function(){function t(e){n(this,t),this.authenticationProvider=e}return a(t,[{key:"execute",value:function(n){return s(this,void 0,void 0,r.mark((function o(){var i,a,s,u,c,d;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i="string"==typeof n.request?n.request:n.request.url,!v(i)){r.next=13;break}return n.middlewareControl instanceof g&&(a=n.middlewareControl.getMiddlewareOptions(O)),a&&(s=a.authenticationProvider,u=a.authenticationProviderOptions),s||(s=this.authenticationProvider),r.next=7,s.getAccessToken(u);case 7:c=r.sent,d="Bearer ".concat(c),R(n.request,n.options,t.AUTHORIZATION_HEADER,d),T.updateFeatureUsageFlag(n,e.FeatureUsageFlag.AUTHENTICATION_HANDLER_ENABLED),r.next=14;break;case 13:n.options.headers&&delete n.options.headers[t.AUTHORIZATION_HEADER];case 14:return r.next=16,this.nextMiddleware.execute(n);case 16:return r.abrupt("return",r.sent);case 17:case"end":return r.stop()}}),o,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),t}();S.AUTHORIZATION_HEADER="Authorization";var P=function(){function e(){n(this,e)}return a(e,[{key:"execute",value:function(e){return s(this,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e.request,e.options);case 2:e.response=t.sent;case 3:case"end":return t.stop()}}),t)})))}}]),e}(),D=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_DELAY,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_MAX_RETRIES,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.defaultShouldRetry;if(n(this,e),t>e.MAX_DELAY&&r>e.MAX_MAX_RETRIES){var i=new Error("Delay and MaxRetries should not be more than ".concat(e.MAX_DELAY," and ").concat(e.MAX_MAX_RETRIES));throw i.name="MaxLimitExceeded",i}if(t>e.MAX_DELAY){var a=new Error("Delay should not be more than ".concat(e.MAX_DELAY));throw a.name="MaxLimitExceeded",a}if(r>e.MAX_MAX_RETRIES){var s=new Error("MaxRetries should not be more than ".concat(e.MAX_MAX_RETRIES));throw s.name="MaxLimitExceeded",s}if(t<0&&r<0){var u=new Error("Delay and MaxRetries should not be negative");throw u.name="MinExpectationNotMet",u}if(t<0){var c=new Error("Delay should not be negative");throw c.name="MinExpectationNotMet",c}if(r<0){var d=new Error("MaxRetries should not be negative");throw d.name="MinExpectationNotMet",d}this.delay=Math.min(t,e.MAX_DELAY),this.maxRetries=Math.min(r,e.MAX_MAX_RETRIES),this.shouldRetry=o}return a(e,[{key:"getMaxDelay",value:function(){return e.MAX_DELAY}}]),e}();D.DEFAULT_DELAY=3,D.DEFAULT_MAX_RETRIES=3,D.MAX_DELAY=180,D.MAX_MAX_RETRIES=10,D.defaultShouldRetry=function(){return!0};var C=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new D;n(this,t),this.options=e}return a(t,[{key:"isRetry",value:function(e){return-1!==t.RETRY_STATUS_CODES.indexOf(e.status)}},{key:"isBuffered",value:function(e,t){var r="string"==typeof e?t.method:e.method;if((r===i.PUT||r===i.PATCH||r===i.POST)&&"application/octet-stream"===E(e,t,"Content-Type"))return!1;return!0}},{key:"getDelay",value:function(e,r,n){var o,i=function(){return Number(Math.random().toFixed(3))},a=void 0!==e.headers?e.headers.get(t.RETRY_AFTER_HEADER):null;return o=null!==a?Number.isNaN(Number(a))?Math.round((new Date(a).getTime()-Date.now())/1e3):Number(a):r>=2?this.getExponentialBackOffTime(r)+n+i():n+i(),Math.min(o,this.options.getMaxDelay()+i())}},{key:"getExponentialBackOffTime",value:function(e){return Math.round(.5*(Math.pow(2,e)-1))}},{key:"sleep",value:function(e){return s(this,void 0,void 0,r.mark((function t(){var n;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=1e3*e,t.abrupt("return",new Promise((function(e){return setTimeout(e,n)})));case 2:case"end":return t.stop()}}),t)})))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new D,this.options)),t}},{key:"executeWithRetry",value:function(e,n,o){return s(this,void 0,void 0,r.mark((function i(){var a;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.nextMiddleware.execute(e);case 2:if(!(n<o.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&o.shouldRetry(o.delay,n,e.request,e.options,e.response))){r.next=13;break}return++n,k(e.request,e.options,t.RETRY_ATTEMPT_HEADER,n.toString()),a=this.getDelay(e.response,n,o.delay),r.next=8,this.sleep(a);case 8:return r.next=10,this.executeWithRetry(e,n,o);case 10:return r.abrupt("return",r.sent);case 13:return r.abrupt("return");case 14:case"end":return r.stop()}}),i,this)})))}},{key:"execute",value:function(t){return s(this,void 0,void 0,r.mark((function n(){var o;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return 0,o=this.getOptions(t),T.updateFeatureUsageFlag(t,e.FeatureUsageFlag.RETRY_HANDLER_ENABLED),r.next=5,this.executeWithRetry(t,0,o);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),n,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),t}();C.RETRY_STATUS_CODES=[429,503,504],C.RETRY_ATTEMPT_HEADER="Retry-Attempt",C.RETRY_AFTER_HEADER="Retry-After";var _=function(){function e(){n(this,e)}return a(e,[{key:"execute",value:function(t){return s(this,void 0,void 0,r.mark((function n(){var o,i,a,s,u;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o="string"==typeof t.request?t.request:t.request.url,v(o)?((i=E(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER))||(i=b(),k(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER,i)),a="".concat(e.PRODUCT_NAME,"/").concat("2.1.0-Preview.2"),t.middlewareControl instanceof g&&(s=t.middlewareControl.getMiddlewareOptions(T)),s&&(u=s.getFeatureUsage(),a+=" (".concat(e.FEATURE_USAGE_STRING,"=").concat(u,")")),R(t.request,t.options,e.SDK_VERSION_HEADER,a)):(delete t.options.headers[e.CLIENT_REQUEST_ID_HEADER],delete t.options.headers[e.SDK_VERSION_HEADER]),r.next=4,this.nextMiddleware.execute(t);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),n,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();_.CLIENT_REQUEST_ID_HEADER="client-request-id",_.SDK_VERSION_HEADER="SdkVersion",_.PRODUCT_NAME="graph-js",_.FEATURE_USAGE_STRING="featureUsage";var L=t((function(e){function t(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=t=function(e){return typeof e}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(r)}e.exports=t})),M=function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_MAX_REDIRECTS,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.defaultShouldRetry;return function(){if(n(t,e),r>e.MAX_MAX_REDIRECTS){var i=new Error("MaxRedirects should not be more than ".concat(e.MAX_MAX_REDIRECTS));throw i.name="MaxLimitExceeded",i}if(r<0){var a=new Error("MaxRedirects should not be negative");throw a.name="MinExpectationNotMet",a}t.maxRedirects=r,t.shouldRedirect=o}()};M.DEFAULT_MAX_REDIRECTS=5,M.MAX_MAX_REDIRECTS=20,M.defaultShouldRetry=function(){return!0};var U=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new M;n(this,t),this.options=e}return a(t,[{key:"isRedirect",value:function(e){return-1!==t.REDIRECT_STATUS_CODES.indexOf(e.status)}},{key:"hasLocationHeader",value:function(e){return e.headers.has(t.LOCATION_HEADER)}},{key:"getLocationHeader",value:function(e){return e.headers.get(t.LOCATION_HEADER)}},{key:"isRelativeURL",value:function(e){return-1===e.indexOf("://")}},{key:"shouldDropAuthorizationHeader",value:function(e,t){var r,n,o=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=o.exec(e);null!==i&&(r=i[0]);var a=o.exec(t);return null!==a&&(n=a[0]),void 0!==r&&void 0!==n&&r!==n}},{key:"updateRequestUrl",value:function(e,t){return s(this,void 0,void 0,r.mark((function n(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("string"!=typeof t.request){r.next=4;break}r.t0=e,r.next=7;break;case 4:return r.next=6,A(e,t.request);case 6:r.t0=r.sent;case 7:t.request=r.t0;case 8:case"end":return r.stop()}}),n)})))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(M)),void 0===t&&(t=Object.assign(new M,this.options)),t}},{key:"executeWithRedirect",value:function(e,n,o){return s(this,void 0,void 0,r.mark((function a(){var s,u;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.nextMiddleware.execute(e);case 2:if(s=e.response,!(n<o.maxRedirects&&this.isRedirect(s)&&this.hasLocationHeader(s)&&o.shouldRedirect(s))){r.next=18;break}if(++n,s.status!==t.STATUS_CODE_SEE_OTHER){r.next=10;break}e.options.method=i.GET,delete e.options.body,r.next=14;break;case 10:return u=this.getLocationHeader(s),!this.isRelativeURL(u)&&this.shouldDropAuthorizationHeader(s.url,u)&&delete e.options.headers[t.AUTHORIZATION_HEADER],r.next=14,this.updateRequestUrl(u,e);case 14:return r.next=16,this.executeWithRedirect(e,n,o);case 16:r.next=19;break;case 18:return r.abrupt("return");case 19:case"end":return r.stop()}}),a,this)})))}},{key:"execute",value:function(n){return s(this,void 0,void 0,r.mark((function o(){var i;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return 0,i=this.getOptions(n),n.options.redirect=t.MANUAL_REDIRECT,T.updateFeatureUsageFlag(n,e.FeatureUsageFlag.REDIRECT_HANDLER_ENABLED),r.next=6,this.executeWithRedirect(n,0,i);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),o,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),t}();U.REDIRECT_STATUS_CODES=[301,302,303,307,308],U.STATUS_CODE_SEE_OTHER=303,U.LOCATION_HEADER="Location",U.AUTHORIZATION_HEADER="Authorization",U.MANUAL_REDIRECT="manual";var N,q=function(){function e(){n(this,e)}return a(e,null,[{key:"getDefaultMiddlewareChain",value:function(e){var t=[],r=new S(e),n=new C(new D),o=new _,i=new P;if(t.push(r),t.push(n),"object"===("undefined"==typeof process?"undefined":L(process))&&"function"==typeof require){var a=new U(new M);t.push(a)}return t.push(o),t.push(i),t}}]),e}();(N=e.ChaosStrategy||(e.ChaosStrategy={}))[N.MANUAL=0]="MANUAL",N[N.RANDOM=1]="RANDOM";var I=function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.ChaosStrategy.RANDOM,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Some error Happened",i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0;if(n(this,t),this.chaosStrategy=r,this.statusCode=i,this.statusMessage=o,this.chaosPercentage=void 0!==a?a:10,this.responseBody=s,this.headers=u,this.chaosPercentage>100)throw new Error("Error Pecentage can not be more than 100")},F={GET:[429,500,502,503,504],POST:[429,500,502,503,504,507],PUT:[429,500,502,503,504,507],PATCH:[429,500,502,503,504],DELETE:[429,500,502,503,504,507]},H={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"},j=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new I,r=arguments.length>1?arguments[1]:void 0;n(this,t),this.options=e,this.manualMap=r}return a(t,[{key:"createResponseHeaders",value:function(e,t,r){var n=e.headers?new Headers(e.headers):new Headers;return n.append("Cache-Control","no-store"),n.append("request-id",t),n.append("client-request-id",t),n.append("x-ms-ags-diagnostic",""),n.append("Date",r),n.append("Strict-Transport-Security",""),429===e.statusCode&&n.append("retry-after","300"),n}},{key:"createResponseBody",value:function(e,t,r){if(e.responseBody)return e.responseBody;var n;e.statusCode>=400?n={error:{code:H[e.statusCode],message:e.statusMessage,innerError:{"request-id":t,date:r}}}:n={};return n}},{key:"createResponse",value:function(e,t){var r=t.request,n=b(),o=new Date,i=this.createResponseHeaders(e,n,o.toString()),a=this.createResponseBody(e,n,o.toString()),s={url:r,status:e.statusCode,statusText:e.statusMessage,headers:i};t.response=new Response(a,s)}},{key:"sendRequest",value:function(e,t){return s(this,void 0,void 0,r.mark((function n(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.setStatusCode(e,t.request,t.options.method),e.statusCode){r.next=6;break}return r.next=4,this.nextMiddleware.execute(t);case 4:r.next=7;break;case 6:this.createResponse(e,t);case 7:case"end":return r.stop()}}),n,this)})))}},{key:"getRandomStatusCode",value:function(e){var t=F[e];return t[Math.floor(Math.random()*t.length)]}},{key:"getRelativeURL",value:function(e){var t,r=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;return null!==r.exec(e)&&(t=r.exec(e)[1]),t}},{key:"setStatusCode",value:function(t,r,n){var o=this;if(t.chaosStrategy===e.ChaosStrategy.MANUAL){if(void 0===t.statusCode){var i=this.getRelativeURL(r);void 0!==this.manualMap.get(i)?void 0!==this.manualMap.get(i).get(n)&&(t.statusCode=this.manualMap.get(i).get(n)):this.manualMap.forEach((function(e,r){new RegExp(r+"$").test(i)&&void 0!==o.manualMap.get(r).get(n)&&(t.statusCode=o.manualMap.get(r).get(n))}))}}else Math.floor(100*Math.random())<t.chaosPercentage&&(t.statusCode=this.getRandomStatusCode(n))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(I)),void 0===t&&(t=Object.assign(new I,this.options)),t}},{key:"execute",value:function(e){return s(this,void 0,void 0,r.mark((function t(){var n;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.getOptions(e),t.next=3,this.sendRequest(n,e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),t}();var B=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},Q=t((function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(r,n)}e.exports=t}));var X=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)};var G=function(e,t){return!t||"object"!==L(t)&&"function"!=typeof t?B(e):t},$=t((function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(r)}e.exports=t}));var V=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")};var z=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}},Y=t((function(e){function t(r,n,o){return z()?e.exports=t=Reflect.construct:e.exports=t=function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&Q(o,r.prototype),o},t.apply(null,arguments)}e.exports=t})),W=t((function(e){function t(r){var n="function"==typeof Map?new Map:void 0;return e.exports=t=function(e){if(null===e||!V(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return Y(e,arguments,$(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Q(t,e)},t(r)}e.exports=t}));function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=$(e);if(t){var o=$(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return G(this,r)}}var J,K,ee,te,re=function(e){X(r,e);var t=Z(r);function r(e){var o;return n(this,r),o=t.call(this,e),Object.setPrototypeOf(B(o),r.prototype),o}return a(r,null,[{key:"setGraphClientError",value:function(e){var t;return e instanceof Error?t=e:(t=new r).customError=e,t}}]),r}(W(Error));(J=e.ResponseType||(e.ResponseType={})).ARRAYBUFFER="arraybuffer",J.BLOB="blob",J.DOCUMENT="document",J.JSON="json",J.RAW="raw",J.STREAM="stream",J.TEXT="text",function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(K||(K={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(ee||(ee={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(te||(te={}));var ne=function(){function t(){n(this,t)}return a(t,null,[{key:"parseDocumentResponse",value:function(e,t){return"undefined"!=typeof DOMParser?new Promise((function(r,n){e.text().then((function(e){try{var o=(new DOMParser).parseFromString(e,t);r(o)}catch(e){n(e)}}))})):Promise.resolve(e.body)}},{key:"convertResponse",value:function(n,o){return s(this,void 0,void 0,r.mark((function i(){var a,s,u;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(204!==n.status){r.next=2;break}return r.abrupt("return",Promise.resolve());case 2:s=n.headers.get("Content-type"),r.t0=o,r.next=r.t0===e.ResponseType.ARRAYBUFFER?6:r.t0===e.ResponseType.BLOB?10:r.t0===e.ResponseType.DOCUMENT?14:r.t0===e.ResponseType.JSON?18:r.t0===e.ResponseType.STREAM?22:r.t0===e.ResponseType.TEXT?26:30;break;case 6:return r.next=8,n.arrayBuffer();case 8:return a=r.sent,r.abrupt("break",59);case 10:return r.next=12,n.blob();case 12:return a=r.sent,r.abrupt("break",59);case 14:return r.next=16,t.parseDocumentResponse(n,K.TEXT_XML);case 16:return a=r.sent,r.abrupt("break",59);case 18:return r.next=20,n.json();case 20:return a=r.sent,r.abrupt("break",59);case 22:return r.next=24,Promise.resolve(n.body);case 24:return a=r.sent,r.abrupt("break",59);case 26:return r.next=28,n.text();case 28:return a=r.sent,r.abrupt("break",59);case 30:if(null===s){r.next=57;break}if(u=s.split(";")[0],!new RegExp(te.DOCUMENT).test(u)){r.next=38;break}return r.next=35,t.parseDocumentResponse(n,u);case 35:a=r.sent,r.next=55;break;case 38:if(!new RegExp(te.IMAGE).test(u)){r.next=42;break}a=n.blob(),r.next=55;break;case 42:if(u!==ee.TEXT_PLAIN){r.next=48;break}return r.next=45,n.text();case 45:a=r.sent,r.next=55;break;case 48:if(u!==ee.APPLICATION_JSON){r.next=54;break}return r.next=51,n.json();case 51:a=r.sent,r.next=55;break;case 54:a=Promise.resolve(n.body);case 55:r.next=58;break;case 57:a=Promise.resolve(n.body);case 58:return r.abrupt("break",59);case 59:return r.abrupt("return",a);case 60:case"end":return r.stop()}}),i)})))}},{key:"getResponse",value:function(n,o,i){return s(this,void 0,void 0,r.mark((function a(){var s;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o!==e.ResponseType.RAW){r.next=4;break}return r.abrupt("return",Promise.resolve(n));case 4:return r.next=6,t.convertResponse(n,o);case 6:if(s=r.sent,!n.ok){r.next=15;break}if("function"!=typeof i){r.next=12;break}i(null,s),r.next=13;break;case 12:return r.abrupt("return",s);case 13:r.next=16;break;case 15:throw s;case 16:case"end":return r.stop()}}),a)})))}}]),t}(),oe=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;n(this,e),this.minValue=t,this.maxValue=r},ie=function(){function e(t,r){n(this,e),this._location=r,this._responseBody=t}return a(e,[{key:"location",get:function(){return this._location},set:function(e){this._location=e}},{key:"responseBody",get:function(){return this._responseBody},set:function(e){this._responseBody=e}}],[{key:"CreateUploadResult",value:function(t,r){return new e(t,r.get("location"))}}]),e}(),ae=function(){function t(e,r,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};n(this,t),this.DEFAULT_FILE_SIZE=5242880,this.client=e,this.file=r,void 0===i.rangeSize&&(i.rangeSize=this.DEFAULT_FILE_SIZE),this.options=i,this.uploadSession=o,this.nextRange=new oe(0,this.options.rangeSize-1)}return a(t,[{key:"parseRange",value:function(e){var t=e[0];if(void 0===t||""===t)return new oe;var r=t.split("-"),n=parseInt(r[0],10),o=parseInt(r[1],10);return Number.isNaN(o)&&(o=this.file.size-1),new oe(n,o)}},{key:"updateTaskStatus",value:function(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}},{key:"getNextRange",value:function(){if(-1===this.nextRange.minValue)return this.nextRange;var e=this.nextRange.minValue,t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new oe(e,t)}},{key:"sliceFile",value:function(e){return this.file.content.slice(e.minValue,e.maxValue+1)}},{key:"upload",value:function(){return s(this,void 0,void 0,r.mark((function e(){var t,n,o,i,a,s;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.uploadSession.isCancelled){e.next=21;break}if(-1!==(t=this.getNextRange()).maxValue){e.next=6;break}throw(n=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file")).name="Invalid Session",n;case 6:return o=this.sliceFile(t),e.next=9,this.uploadSliceGetRawResponse(o,t,this.file.size);case 9:if(i=e.sent){e.next=12;break}throw new re("Something went wrong! Large file upload slice response is null.");case 12:return e.next=14,ne.getResponse(i);case 14:if(a=e.sent,!(201===i.status||200===i.status&&a.id)){e.next=17;break}return e.abrupt("return",ie.CreateUploadResult(a,i.headers));case 17:s={expirationDateTime:a.expirationDateTime,nextExpectedRanges:a.NextExpectedRanges||a.nextExpectedRanges},this.updateTaskStatus(s),e.next=0;break;case 21:case"end":return e.stop()}}),e,this)})))}},{key:"uploadSlice",value:function(e,t,n){return s(this,void 0,void 0,r.mark((function o(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.client.api(this.uploadSession.url).headers({"Content-Length":"".concat(t.maxValue-t.minValue+1),"Content-Range":"bytes ".concat(t.minValue,"-").concat(t.maxValue,"/").concat(n)}).put(e);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),o,this)})))}},{key:"uploadSliceGetRawResponse",value:function(t,n,o){return s(this,void 0,void 0,r.mark((function i(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.client.api(this.uploadSession.url).headers({"Content-Length":"".concat(n.maxValue-n.minValue+1),"Content-Range":"bytes ".concat(n.minValue,"-").concat(n.maxValue,"/").concat(o)}).responseType(e.ResponseType.RAW).put(t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),i,this)})))}},{key:"cancel",value:function(){return s(this,void 0,void 0,r.mark((function t(){var n;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.api(this.uploadSession.url).responseType(e.ResponseType.RAW).delete();case 2:return 204===(n=t.sent).status&&(this.uploadSession.isCancelled=!0),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"getStatus",value:function(){return s(this,void 0,void 0,r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.api(this.uploadSession.url).get();case 2:return t=e.sent,this.updateTaskStatus(t),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"resume",value:function(){return s(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getStatus();case 2:return e.next=4,this.upload();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getUploadSession",value:function(){return this.uploadSession}}],[{key:"createUploadSession",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return s(this,void 0,void 0,r.mark((function i(){var a,s;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.api(t).headers(o).post(n);case 2:return a=r.sent,s={url:a.uploadUrl,expiry:new Date(a.expirationDateTime),isCancelled:!1},r.abrupt("return",s);case 5:case"end":return r.stop()}}),i)})))}}]),t}();var se=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$(e)););return e},ue=t((function(e){function t(r,n,o){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=t=Reflect.get:e.exports=t=function(e,t,r){var n=se(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}},t(r,n,o||r)}e.exports=t})),ce=function(e){return e>327680&&(e=320*Math.floor(e/327680)*1024),e},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5242880,t=62914560;return e>t&&(e=t),ce(e)};function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=$(e);if(t){var o=$(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return G(this,r)}}var fe=function(e){X(o,e);var t=le(o);function o(e,r,i,a){return n(this,o),t.call(this,e,r,i,a)}return a(o,[{key:"commit",value:function(e){return s(this,void 0,void 0,r.mark((function t(){var n;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={name:this.file.name,"@microsoft.graph.conflictBehavior":"rename","@microsoft.graph.sourceUrl":this.uploadSession.url},t.next=3,this.client.api(e).put(n);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})))}}],[{key:"constructCreateSessionUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.DEFAULT_UPLOAD_PATH;return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t="/".concat(t)),"/"!==t[t.length-1]&&(t="".concat(t,"/")),"/me/drive/root:".concat(t.split("/").map((function(e){return encodeURIComponent(e)})).join("/")).concat(encodeURIComponent(e),":/createUploadSession")}},{key:"create",value:function(e,t,n){return s(this,void 0,void 0,r.mark((function i(){var a,s,u,c,d,l,f,h;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=n.fileName,"undefined"!=typeof Blob&&t instanceof Blob?(s=new File([t],a),u=s.size):"undefined"!=typeof File&&t instanceof File?u=(s=t).size:"undefined"!=typeof Buffer&&t instanceof Buffer&&(u=(c=t).byteLength-c.byteOffset,s=c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)),d=o.constructCreateSessionUrl(n.fileName,n.path),r.next=5,o.createUploadSession(e,d,n.fileName);case 5:return l=r.sent,f=de(n.rangeSize),h={content:s,name:a,size:u},r.abrupt("return",new o(e,h,l,{rangeSize:f}));case 9:case"end":return r.stop()}}),i)})))}},{key:"createUploadSession",value:function(e,t,n){var i=this,a=Object.create(null,{createUploadSession:{get:function(){return ue($(o),"createUploadSession",i)}}});return s(this,void 0,void 0,r.mark((function o(){var i;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={item:{"@microsoft.graph.conflictBehavior":"rename",name:n}},r.abrupt("return",a.createUploadSession.call(this,e,t,i));case 2:case"end":return r.stop()}}),o,this)})))}}]),o}(ae);fe.DEFAULT_UPLOAD_PATH="/";var he=function(){function e(t,r,o,i){n(this,e),this.client=t,this.collection=r.value,this.nextLink=r["@odata.nextLink"],this.deltaLink=r["@odata.deltaLink"],this.callback=o,this.complete=!1,this.requestOptions=i}return a(e,[{key:"iterationHelper",value:function(){if(void 0===this.collection)return!1;for(var e=!0;e&&0!==this.collection.length;){var t=this.collection.shift();e=this.callback(t)}return e}},{key:"fetchAndUpdateNextPageData",value:function(){return s(this,void 0,void 0,r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.client.api(this.nextLink),this.requestOptions&&(this.requestOptions.headers&&(t=t.headers(this.requestOptions.headers)),this.requestOptions.middlewareOptions&&(t=t.middlewareOptions(this.requestOptions.middlewareOptions)),this.requestOptions.options&&(t=t.options(this.requestOptions.options))),e.next=4,t.get();case 4:n=e.sent,this.collection=n.value,this.nextLink=n["@odata.nextLink"],this.deltaLink=n["@odata.deltaLink"];case 8:case"end":return e.stop()}}),e,this)})))}},{key:"getDeltaLink",value:function(){return this.deltaLink}},{key:"iterate",value:function(){return s(this,void 0,void 0,r.mark((function e(){var t;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.iterationHelper();case 1:if(!t){e.next=11;break}if(void 0===this.nextLink){e.next=8;break}return e.next=5,this.fetchAndUpdateNextPageData();case 5:t=this.iterationHelper(),e.next=9;break;case 8:t=!1;case 9:e.next=1;break;case 11:void 0===this.nextLink&&0===this.collection.length&&(this.complete=!0);case 12:case"end":return e.stop()}}),e,this)})))}},{key:"resume",value:function(){return s(this,void 0,void 0,r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.iterate());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"isComplete",value:function(){return this.complete}}]),e}();var pe=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n};var ve=function(e){if(Array.isArray(e))return pe(e)};var ye=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)};var me=function(e,t){if(e){if("string"==typeof e)return pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pe(e,t):void 0}};var ge=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var xe=function(e){return ve(e)||ye(e)||me(e)||ge()},we=function(){function e(t){n(this,e),this.provider=t}return a(e,[{key:"getAccessToken",value:function(){return s(this,void 0,void 0,r.mark((function e(){var t=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.provider((function(o,i){return s(t,void 0,void 0,r.mark((function t(){var a;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i){t.next=4;break}e(i),t.next=9;break;case 4:return o||("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md",o=new re("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")),t.next=7,re.setGraphClientError(o);case 7:a=t.sent,n(a);case 9:case"end":return t.stop()}}),t)})))}))})));case 1:case"end":return e.stop()}}),e)})))}}]),e}();function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=$(e);if(t){var o=$(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return G(this,r)}}var Ee=function(e){X(r,e);var t=be(r);function r(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return n(this,r),e=t.call(this,i||a&&a.message),Object.setPrototypeOf(B(e),r.prototype),e.statusCode=o,e.code=null,e.requestId=null,e.date=new Date,e.body=null,e.stack=a?a.stack:e.stack,e}return r}(W(Error)),ke=function(){function e(){n(this,e)}return a(e,null,[{key:"constructError",value:function(e,t){var r=new Ee(t,"",e);return void 0!==e.name&&(r.code=e.name),r.body=e.toString(),r.date=new Date,r}},{key:"constructErrorFromResponse",value:function(e,t){var r=e.error,n=new Ee(t,r.message);return n.code=r.code,void 0!==r.innerError&&(n.requestId=r.innerError["request-id"],n.date=new Date(r.innerError.date)),n.body=JSON.stringify(r),n}},{key:"getError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=arguments.length>2?arguments[2]:void 0;return s(this,void 0,void 0,r.mark((function i(){var a;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t&&t.error?a=e.constructErrorFromResponse(t,n):t instanceof Error?a=e.constructError(t,n):(a=new Ee(n)).body=t,"function"!=typeof o){r.next=5;break}o(a,null),r.next=6;break;case 5:return r.abrupt("return",a);case 6:case"end":return r.stop()}}),i)})))}}]),e}();function Re(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ae(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ae(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Oe=function(){function t(e,r,o){var i=this;n(this,t),this.parsePath=function(e){if(-1!==e.indexOf("https://")){var t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(i.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));var r=e.indexOf("/");-1!==r&&(i.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));var n=e.indexOf("?");if(-1===n)i.urlComponents.path=e;else{i.urlComponents.path=e.substr(0,n);var o,a=Re(e.substring(n+1,e.length).split("&"));try{for(a.s();!(o=a.n()).done;){var s=o.value;i.parseQueryParameter(s)}}catch(e){a.e(e)}finally{a.f()}}},this.httpClient=e,this.config=r,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(o)}return a(t,[{key:"addCsvQueryParameter",value:function(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";var n=[];r.length>1&&"string"==typeof t?n=Array.prototype.slice.call(r):"string"==typeof t?n.push(t):n=n.concat(t),this.urlComponents.oDataQueryParams[e]+=n.join(",")}},{key:"buildFullUrl",value:function(){var e,t,r=(e=[this.urlComponents.host,this.urlComponents.version,this.urlComponents.path],t=function(e){return e.replace(/^\/+/,"")},Array.prototype.slice.call(e).reduce((function(e,r){return[(n=e,n.replace(/\/+$/,"")),t(r)].join("/");var n}))+this.createQueryString());return this.config.debugLogging&&console.log(r),r}},{key:"createQueryString",value:function(){var e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(var r in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(var n in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,n)&&t.push(n+"="+e.otherURLQueryParams[n]);if(0!==e.otherURLQueryOptions.length){var o,i=Re(e.otherURLQueryOptions);try{for(i.s();!(o=i.n()).done;){var a=o.value;t.push(a)}}catch(e){i.e(e)}finally{i.f()}}return t.length>0?"?"+t.join("&"):""}},{key:"parseQueryParameter",value:function(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){var t,r=Re(e.split("&"));try{for(r.s();!(t=r.n()).done;){var n=t.value;this.parseQueryParamenterString(n)}}catch(e){r.e(e)}finally{r.f()}}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&this.setURLComponentsQueryParamater(o,e[o]);return this}},{key:"parseQueryParamenterString",value:function(e){if(this.isValidQueryKeyValuePair(e)){var t=e.indexOf("="),r=e.substring(0,t),n=e.substring(t+1);this.setURLComponentsQueryParamater(r,n)}else this.urlComponents.otherURLQueryOptions.push(e)}},{key:"setURLComponentsQueryParamater",value:function(e,t){if(-1!==h.indexOf(e)){var r=this.urlComponents.oDataQueryParams[e],n=r&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=n?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}},{key:"isValidQueryKeyValuePair",value:function(e){var t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}},{key:"updateRequestOptions",value:function(e){var t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){var r=Object.assign({},this.config.fetchOptions);Object.assign(e,r),void 0!==L(this.config.fetchOptions.headers)&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}},{key:"send",value:function(e,t,n){return s(this,void 0,void 0,r.mark((function o(){var i,a,s,u,c;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=new g(this._middlewareOptions),this.updateRequestOptions(t),r.prev=2,r.next=5,this.httpClient.sendRequest({request:e,options:t,middlewareControl:a});case 5:return s=r.sent,i=s.response,r.next=9,ne.getResponse(i,this._responseType,n);case 9:return u=r.sent,r.abrupt("return",u);case 13:if(r.prev=13,r.t0=r.catch(2),!(r.t0 instanceof re)){r.next=17;break}throw r.t0;case 17:return i&&(c=i.status),r.next=20,ke.getError(r.t0,c,n);case 20:throw r.sent;case 22:case"end":return r.stop()}}),o,this,[[2,13]])})))}},{key:"setHeaderContentType",value:function(){if(this._headers){for(var e=0,t=Object.keys(this._headers);e<t.length;e++){if("content-type"===t[e].toLowerCase())return}this.header("Content-Type","application/json")}else this.header("Content-Type","application/json")}},{key:"header",value:function(e,t){return this._headers[e]=t,this}},{key:"headers",value:function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}},{key:"option",value:function(e,t){return this._options[e]=t,this}},{key:"options",value:function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}},{key:"middlewareOptions",value:function(e){return this._middlewareOptions=e,this}},{key:"version",value:function(e){return this.urlComponents.version=e,this}},{key:"responseType",value:function(e){return this._responseType=e,this}},{key:"select",value:function(e){return this.addCsvQueryParameter("$select",e,arguments),this}},{key:"expand",value:function(e){return this.addCsvQueryParameter("$expand",e,arguments),this}},{key:"orderby",value:function(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}},{key:"filter",value:function(e){return this.urlComponents.oDataQueryParams.$filter=e,this}},{key:"search",value:function(e){return this.urlComponents.oDataQueryParams.$search=e,this}},{key:"top",value:function(e){return this.urlComponents.oDataQueryParams.$top=e,this}},{key:"skip",value:function(e){return this.urlComponents.oDataQueryParams.$skip=e,this}},{key:"skipToken",value:function(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}},{key:"count",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.urlComponents.oDataQueryParams.$count=e.toString(),this}},{key:"query",value:function(e){return this.parseQueryParameter(e)}},{key:"get",value:function(e){return s(this,void 0,void 0,r.mark((function t(){var n,o,a;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.buildFullUrl(),o={method:i.GET},t.next=4,this.send(n,o,e);case 4:return a=t.sent,t.abrupt("return",a);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"post",value:function(e,t){return s(this,void 0,void 0,r.mark((function n(){var o,a;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=this.buildFullUrl(),a={method:i.POST,body:p(e)},"FormData"===(e&&e.constructor&&e.constructor.name)?a.headers={}:(this.setHeaderContentType(),a.headers=this._headers),r.next=6,this.send(o,a,t);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),n,this)})))}},{key:"create",value:function(e,t){return s(this,void 0,void 0,r.mark((function n(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.post(e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),n,this)})))}},{key:"put",value:function(e,t){return s(this,void 0,void 0,r.mark((function n(){var o,a;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=this.buildFullUrl(),this.setHeaderContentType(),a={method:i.PUT,body:p(e)},r.next=5,this.send(o,a,t);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),n,this)})))}},{key:"patch",value:function(e,t){return s(this,void 0,void 0,r.mark((function n(){var o,a;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=this.buildFullUrl(),this.setHeaderContentType(),a={method:i.PATCH,body:p(e)},r.next=5,this.send(o,a,t);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),n,this)})))}},{key:"update",value:function(e,t){return s(this,void 0,void 0,r.mark((function n(){return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.patch(e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),n,this)})))}},{key:"delete",value:function(e){return s(this,void 0,void 0,r.mark((function t(){var n,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.buildFullUrl(),o={method:i.DELETE},t.next=4,this.send(n,o,e);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"del",value:function(e){return s(this,void 0,void 0,r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.delete(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getStream",value:function(t){return s(this,void 0,void 0,r.mark((function n(){var o,a;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=this.buildFullUrl(),a={method:i.GET},this.responseType(e.ResponseType.STREAM),r.next=5,this.send(o,a,t);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),n,this)})))}},{key:"putStream",value:function(e,t){return s(this,void 0,void 0,r.mark((function n(){var o,a;return r.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=this.buildFullUrl(),a={method:i.PUT,headers:{"Content-Type":"application/octet-stream"},body:e},r.next=4,this.send(o,a,t);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),n,this)})))}}]),t}(),Te=function(){function e(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];if(n(this,e),!r||!r.length){var i=new Error;throw i.name="InvalidMiddlewareChain",i.message="Please provide a default middleware chain or custom middleware chain",i}this.setMiddleware.apply(this,r)}return a(e,[{key:"setMiddleware",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t.length>1?this.parseMiddleWareArray(t):this.middleware=t[0]}},{key:"parseMiddleWareArray",value:function(e){e.forEach((function(t,r){r<e.length-1&&t.setNext(e[r+1])})),this.middleware=e[0]}},{key:"sendRequest",value:function(e){return s(this,void 0,void 0,r.mark((function t(){var n;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e.request||void 0!==e.options){t.next=5;break}throw(n=new Error).name="InvalidRequestOptions",n.message="Unable to execute the middleware, Please provide valid options for a request",n;case 5:return t.next=7,this.middleware.execute(e);case 7:return t.abrupt("return",e);case 8:case"end":return t.stop()}}),t,this)})))}}]),e}(),Se=function(){function e(){n(this,e)}return a(e,null,[{key:"createWithAuthenticationProvider",value:function(t){var r=new S(t),n=new C(new D),o=new _,i=new P;if(r.setNext(n),"object"===("undefined"==typeof process?"undefined":L(process))&&"function"==typeof require){var a=new U(new M);n.setNext(a),a.setNext(o)}else n.setNext(o);return o.setNext(i),e.createWithMiddleware(r)}},{key:"createWithMiddleware",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Y(Te,t)}}]),e}(),Pe=function(){function e(t){for(var r in n(this,e),this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},function(){if("undefined"==typeof Promise&&"undefined"==typeof fetch){var e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){var t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof fetch){var r=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}}(),t)Object.prototype.hasOwnProperty.call(t,r)&&(this.config[r]=t[r]);var o;if(void 0!==t.authProvider&&void 0!==t.middleware){var i=new Error;throw i.name="AmbiguityInInitialization",i.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",i}if(void 0!==t.authProvider)o=Se.createWithAuthenticationProvider(t.authProvider);else{if(void 0===t.middleware){var a=new Error;throw a.name="InvalidMiddlewareChain",a.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",a}o=Y(Te,xe([].concat(t.middleware)))}this.httpClient=o}return a(e,[{key:"api",value:function(e){return new Oe(this.httpClient,this.config,e)}}],[{key:"init",value:function(t){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]="authProvider"===n?new we(t[n]):t[n]);return e.initWithMiddleware(r)}},{key:"initWithMiddleware",value:function(t){return new e(t)}}]),e}(),De=function(){function e(t,r){n(this,e),this.options=r,this.msalApplication=t}return a(e,[{key:"getAccessToken",value:function(e){return s(this,void 0,void 0,r.mark((function t(){var n,o,i,a,s,u,c,d;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(n=e)&&(o=n.scopes),void 0!==o&&0!==o.length||(o=this.options.scopes),0!==o.length){t.next=8;break}throw(i=new Error).name="EmptyScopes",i.message="Scopes cannot be empty, Please provide a scopes",i;case 8:if(!this.msalApplication.getAccount()){t.next=29;break}return a={scopes:o},t.prev=10,t.next=13,this.msalApplication.acquireTokenSilent(a);case 13:return s=t.sent,t.abrupt("return",s.accessToken);case 17:if(t.prev=17,t.t0=t.catch(10),"InteractionRequiredAuthError"!==t.t0.name){t.next=26;break}return t.next=22,this.msalApplication.acquireTokenPopup(a);case 22:return u=t.sent,t.abrupt("return",u.accessToken);case 26:throw t.t0;case 27:t.next=36;break;case 29:return c={scopes:o},t.next=32,this.msalApplication.loginPopup(c);case 32:return t.next=34,this.msalApplication.acquireTokenSilent(c);case 34:return d=t.sent,t.abrupt("return",d.accessToken);case 36:case"end":return t.stop()}}),t,this,[[10,17]])})))}}]),e}();return e.AuthenticationHandler=S,e.AuthenticationHandlerOptions=O,e.BatchRequestContent=d,e.BatchResponseContent=l,e.ChaosHandler=j,e.ChaosHandlerOptions=I,e.Client=Pe,e.CustomAuthenticationProvider=we,e.GraphError=Ee,e.GraphRequest=Oe,e.HTTPMessageHandler=P,e.ImplicitMSALAuthenticationProvider=De,e.LargeFileUploadTask=ae,e.MSALAuthenticationProviderOptions=function e(t){n(this,e),this.scopes=t},e.MiddlewareFactory=q,e.OneDriveLargeFileUploadTask=fe,e.PageIterator=he,e.RetryHandler=C,e.RetryHandlerOptions=D,e.TelemetryHandler=_,e.TelemetryHandlerOptions=T,e}({});
